<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="./js/_.js"></script>
</head>
<body>
<script>
// 컬렉션 중심 프로그래밍의 4가지 유형과 함수

// 1. 수집하기 - map, value, pluck 등
// 2. 거르기 - filter, reject, compact, without 등
// 3. 찾아내기 - find, some, every 등
// 4. 접기 - reduce, min, max, group_by, count_by 등

let users  = [
    {id:10, name:'ID', age:36},
    {id:20, name:'BJ', age:32},
    {id:30, name:'JM', age:32},
    {id:40, name:'PJ', age:27},
    {id:50, name:'HA', age:25},
    {id:60, name:'JE', age:26},
    {id:70, name:'JI', age:31},
    {id:80, name:'MP', age:23},
    {id:90, name:'FP', age:13}
];

// 컬렉션 중심 프로그래밍의 유형별 함수 만들기

// 1. 수집하기 - map

    console.log(
        _map(users, function(user) {
            return user.name;
        })
    );

    // 1.1 values (key가 obj일 경우)
    /* 
    function _values(data) {
        return _map(data, function(val) { return val; });
    }
    */
 
    function _values(data) {
        return _map(data, _identity);
    }

    // 또 방식의 _values 구현
    var _values = _map(_identity); // _map은 현재 _curryr로 구현

    function _identity(val) {
        return val;
    }

    // 1.2 pluck
    /*
    function _pluck(data, key) {
        return _map(data, function(obj) {
            return obj[key];
        })
    }
    */
    function _pluck(data, key) {
        return _map(data, _get(key));
    }

    // --------------------- func test --------------------- //
    
    console.log( users[0] );
    console.log( _keys(users[0]) );
    console.log( _values(users[0]) );
    
    console.log( _pluck(users, 'age'));
    console.clear();
    
// 2. 거르기 - filter
    
    function _negate(func) {
        return function(val) {
            return !func(val);
        }
    }
    
    // 1.1 reject (filter의 반대 false인 데이터를 추출)
    /*
    function _reject(data, predi) {
        return _filter(data, function(val) {
            return !predi(val);
        });
    }
    */
   function _reject(data, predi) {
       return _filter(data, _negate(predi));
    }
    
    // 1.2 compact (true 한 값을 남김)
    var _compact = _filter(_identity);
    
    // --------------------- func test --------------------- //
    
    console.log(
        `compact fn`,
        _compact([1, 2, 0, false, null, {}])
    );
    console.clear();

// 3. 찾아내기 - find
    // 3.1 find 만들기 (predi 조건에 맞는 최초의 값 가져오기)
    /*
    function _find(list, predi) {
        var keys = _keys(list);
        for (var i = 0, len = keys.length; i < len; i++) {
            var val = list[keys[i]];
            if (predi(val)) return val;
        }
    }
    */
   
    var _find = _curryr(function(list, predi) {
        var keys = _keys(list);
        for (var i = 0, len = keys.length; i < len; i++) {
            var val = list[keys[i]];
            if (predi(val)) return val;
        }
    });

    // 3.2 find_index 
    var _find_index = _curryr(function(list, predi) {
        var keys = _keys(list);
        for (var i = 0, len = keys.length; i < len; i++) {
            if (predi(list[keys[i]])) return i;
        }
        return -1;
    });
    // 3.3 some
    // 3.4 every

    // --------------------- func test --------------------- //
    
    console.log(
        _find(users, function(user) {
            return user.age > 30;
        })
    );
        
    console.log(
        _find_index(users, function(user) {
            return user.id == 20;
        })
    );

    // 응용
    console.log(
        _get(_find(users, function(user) {
            return user.id == 20;
        }), 'name')
    );

    _go(
        _find(users, function(user) {
            return user.id == 50;
        }),
        _get('name'),
        console.log
    );
    
    // 4. 접기 - reduce
    // 4.1 min, max, min_by, max_by
    // 4.2 group_by, push
    // 4.3 count_by, inc
    </script>
</body>
</html>